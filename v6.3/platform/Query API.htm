<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" class="concept _Skins_HTML5___Side_Navigation_2021" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../" data-mc-has-content-body="True" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="API References|Server-side API">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="Expires" content="0" />
        <meta http-equiv="Pragma" content="no-cache" />
        <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="msapplication-config" content="../Skins/Favicons/browserconfig.xml" />
        <link rel="apple-touch-icon" sizes="192x192" href="../Skins/Favicons/IB_favicon_192x192.png" />
        <link rel="shortcut icon" href="../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="96x96" href="../Skins/Favicons/IB_favicon_96x96.png" />
        <link rel="icon" sizes="32x32" href="../Skins/Favicons/IB_favicon_32x32.png" />
        <link rel="icon" sizes="16x16" href="../Skins/Favicons/IB_favicon_16x16.png" /><title>Query API</title>
        <!-- Global site tag (gtag.js) - Google Analytics -->
        <script>/* <![CDATA[ */
			window.dataLayer = window.dataLayer || [];
			function gtag(){dataLayer.push(arguments);}
			gtag('js', new Date());

			gtag('config', 'UA-164223934-1');
	/* ]]> */</script>
        <!-- Version dropdown -->
        <script type="text/javascript">/* <![CDATA[ */
			function gotopage(selval){
			var value = selval.options[selval.selectedIndex].value;
			window.location.href=value;
			}
		/* ]]> */</script>
        <link href="../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" />
        <link href="../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" />
        <link href="../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" />
        <link href="../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" />
        <link href="../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" />
        <link href="../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" />
        <link href="../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" />
        <link href="../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" />
        <link href="../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" />
        <link href="../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" />
        <link href="../Resources/Stylesheets/ib_platform.css" rel="stylesheet" />
        <script src="../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../Resources/Scripts/require.min.js" defer="defer">
        </script>
        <script src="../Resources/Scripts/require.config.js" defer="defer">
        </script>
        <script src="../Resources/Scripts/foundation.6.2.3_custom.js" defer="defer">
        </script>
        <script src="../Resources/Scripts/plugins.min.js" defer="defer">
        </script>
        <script src="../Resources/Scripts/MadCapAll.js" defer="defer">
        </script>
        <script src="../Resources/Scripts/jira_issue_collector.js">
        </script>
        <script src="https://www.googletagmanager.com/gtag/js?id=UA-164223934-1">
        </script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-left" role="navigation" id="offCanvas" data-off-canvas="" data-position="left" data-mc-ignore="true">
                    <ul class="off-canvas-accordion vertical menu off-canvas-list" data-accordion-menu="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="only screen and (max-device-width: 1279px)" data-mc-ignore="true"><a class="skip-to-content fluid-skip showOnFocus" href="#">Skip To Main Content</a>
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <button class="menu-icon" aria-label="Show Navigation Panel" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="../Welcome.htm" alt="Logo"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="3" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search our documentation..." />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filter: </span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">All Files</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search" role="button" tabindex="0"><span class="invisible-label">Submit Search</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <nav class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </nav>
                            <main id="main" class="body-container">
                                <div data-mc-content-body="True">
                                    <div style=" text-align: right; border-radius: 4px; color:white; font-size: 9pt; background: linear-gradient(0deg, rgba(35,129,195,1) 35%, rgba(2,54,96,1) 100%); margin-bottom: 15px; padding: 4px 12px; ">Documentation Version 
		<select class="minimal" onchange="gotopage(this)"><option value="">6.3 (current)</option><option value="https://documentation.infiniteblue.com/6.2/platform/What's%20New%20in%20Platform%206.2.htm" target="_blank">6.2</option><option value="https://documentation.infiniteblue.com/6.4/platform/What's%20New%20in%20Platform%206.4.htm" target="_blank">6.4</option><option value="https://documentation.infiniteblue.com/6.5/platform/What's%20New%20in%20Platform%206.5.htm" target="_blank">6.5</option><option value="https://documentation.infiniteblue.com/platform/What's%20New%20in%20Platform%206.6.htm" target="_blank">6.6</option></select></div>
                                    <div class="nocontent">
                                        <div class="MCBreadcrumbsBox_0 breadcrumbs" role="navigation" aria-label="Breadcrumbs" data-mc-breadcrumbs-divider=" &gt; " data-mc-breadcrumbs-count="3" data-mc-toc="True"><span class="MCBreadcrumbsPrefix">You are here: </span>
                                        </div>
                                    </div>
                                    <div class="home-container">
                                        <h1 class="concepttitle">Query API</h1>
                                        <div class="section">
                                            <p>The Platform Query API is available for all server-side formulas. To access these
        methods, use the <code>rbv_api</code> system object. The order of query
        parameters is set and cannot be changed. </p>
                                            <p>Queries support the following syntax:</p><pre>SELECT expression FROM object_name {WHERE expression} {GROUP BY
   expression} {ORDER BY expression}</pre>
                                            <p>The <code>SELECT</code> statement consists of the following parts:</p>
                                            <ul>
                                                <li value="1"><code>SELECT</code> lists
     columns or expressions to be selected (mandatory)</li>
                                                <li value="2">Use field integration names as SQL column names. You can use expressions such as
            <code>COUNT(1)</code>. Selecting all columns with star (*) is not supported.</li>
                                                <li value="3"><code>FROM</code> clause must consist of exactly one and only one object name
          (mandatory).</li>
                                                <li value="4"><code>WHERE</code> clause includes a valid SQL expression to narrow the selection
          (optional). Use field integration names as SQL column names.</li>
                                                <li value="5"><code>GROUP BY</code> clause includes an expression (typically a valid field name) to
          group selection (optional).</li>
                                                <li value="6"><code>ORDER BY</code> clause includes a valid SQL expression to order selection
          (optional).</li>
                                            </ul>
                                        </div>
                                        <div class="section">
                                            <h2 class="sectiontitle">Query Limitations</h2>
                                            <p>Only data fields with stored input values (text, decimal, etc.) can be used
        in a <code>SELECT</code> expression. Dependent fields, such as formulas,
        cannot be used in query methods. A relationship (i.e. Lookup) field can be used, but will
        only take the ID of the first related record--not an array of all related records. Related
        fields can be used if they point to a data field. </p>
                                            <p>The limitation
        preventing formulas from being used in the Query API can be easily bypassed in simple cases.
        </p>
                                            <p>Consider this Formula: <code>{!amount} *
          {!price}</code></p>
                                            <p>Though you cannot use this Formula in a query directly, you can create a
        query such as:</p><pre>SELECT SUM(amount*price)
    FROM order WHERE ...</pre>
                                            <p>For conditions involving date fields, you can use special tokens:</p>
                                            <ul>
                                                <li value="1"><code>TODAY</code> for the current time</li>
                                                <li value="2"><code>WEEK </code>for 12 AM of last Sunday</li>
                                                <li value="3"><code>MONTH</code> for 12 AM of 1st day of the current month</li>
                                                <li value="4"><code>QUARTER</code> for 12 AM of 1st day of the current
          quarter</li>
                                                <li value="5"><code>YEAR</code> for 12 AM of 1st day of the current year</li>
                                                <li value="6"><code>CURR_USER</code> for id of the currently logged in user</li>
                                            </ul>
                                            <p>You can also use built-in functions: <ul><li value="1"><code>#YEAR(date)</code> returns the date's year
            as an integer</li><li value="2"><code>#MONTH(date)</code> returns the date's month
            as an integer in the range of 1 - 12</li><li value="3"><code>#DAY(date)</code> returns the date's day of
            the month as an integer</li><li value="4"><code>#ISO(literal_string)</code> returns the date
            or date/time in ISO format, which can be used in a query. Examples: <code>#ISO(2013-09-20T)</code>, <code>#ISO(2013-09-20T20:05:01Z)</code></li><li value="5"><code>#IF(expr, val1, val2)</code> returns
              <span class="varname">val1</span> if <span class="varname">expr</span> is
            evaluated to true, <span class="varname">val2</span> otherwise.</li></ul></p>
                                            <p> The following query selects records created in the current year (starting
        from midnight January 1st) by current user:</p><pre>SELECT name, id FROM order WHERE
    createdAt&gt;=YEAR &amp;&amp; createdBy=CURR_USER </pre>
                                            <p>Query methods do not support arithmetic operations with data tokens like
        view filters do. For instance, <code>MONTH-1</code> does not represent
        the first day of the previous month. You should use a query with parameters instead. If a
        query includes a <code>Date</code> or <code>Date/Time</code> column, an instance of the JavaScript <code>Date</code> class is returned. You can use any JavaScript <code>Date</code> class methods. See <a href="rbv_api.selectValue().htm"><code xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">selectValue()</code></a> for a code example.</p>
                                            <p>You can also use single-quoted integration codes for picklists and status
        fields in a query <code>WHERE</code> clause. For example:</p><pre>SELECT count(1) FROM order WHERE status='Q'</pre>
                                            <p>The following example reads records of where the user role integration code
        equals <code>SALES</code>:</p><pre>SELECT loginName, role,
    email FROM USER WHERE role = 'SALES'</pre>
                                            <p>0bject and field integration names are case-sensitive, while other
        components of an SQL query are not. When an integration code is used to reference pick list
        item, status, or role in the query, the corresponding item must actually exist and be
        unique. This means that two picklists in the query object cannot use the same integration
        code. Otherwise, the integration code will not be resolved and will likely cause a query
        error. </p>
                                            <p>If you query values of picklist fields, you will get numeric
        values corresponding to the ID of a selected item. If you wish to receive the integration
        code of the selected item instead, add the <code>#code</code> suffix to
        the name of the picklist field. Add the <code>#value</code> suffix to
        extract the display name of the selected item. The same syntax can be used for multi-select
        picklists, status fields, radio Buttons etc. For example:</p>
                                            <ul>
                                                <li value="1"><code> SELECT my_piclkist FROM invoice WHERE
            id={!id)</code>: returns the numeric ID of selected item</li>
                                                <li value="2"><code>SELECT my_piclkist#code FROM invoice WHERE
            id={!id)</code>: returns the integration code of selected item</li>
                                                <li value="3"><code>SELECT my_piclkist#value FROM invoice WHERE
            id={!id)</code>: returns the display name of selected item</li>
                                            </ul>
                                            <p>Examples of valid queries for the User object:</p>
                                            <ul>
                                                <li value="1">Select fields for users whose name starts with ‘M': <code>SELECT id, name, updatedAt, updatedBy FROM USER WHERE name LIKE 'M%'
            ORDER BY name</code></li>
                                                <li value="2">Count number of users whose name starts with ‘M': <code>SELECT count(1) FROM USER WHERE name LIKE 'M%'</code></li>
                                                <li value="3"> Count number of users created or updated in current quarter: <code>SELECT count(1) FROM USER WHERE updatedBy&gt;=QUARTER</code></li>
                                                <li value="4">Count number of approval records for current record (identified by
            <code>{!id} token)</code>: <code>SELECT count(1)
            FROM $APPROVAL WHERE approvedRecord={!id}</code></li>
                                                <li value="5">Summarize <code>amount*price</code> expression for
          all records per category (picklist): <code>SELECT sum(amount*price),
            category FROM sales GROUP BY category</code></li>
                                                <li value="6">Extract records created between two
          dates:<pre>var d1 = new Date('2/2/2014');
var d2 = new Date('4/2/2014');
var arr = rbv_api.selectQuery(
"SELECT id, name FROM a1 WHERE createdAt BETWEEN ? AND ?", 100, d1, d2);
rbv_api.printArr(arr);
</pre></li>
                                            </ul>
                                            <p> Example of an HTML report that displays the total number of users in
        the system:</p><pre>&lt;html&gt;&lt;h2&gt;
    Total users: #EVAL[ rbv_api.selectValue("SELECT COUNT(1) FROM USER") ]
&lt;/h2&gt;&lt;/html&gt;</pre>
                                            <p>Although UI views do not make distinction between NULL values and 0 for
        numeric fields, the query API treats NULL values and 0 differently. To mimic UI behavior you
        need to explicitly filter NULL values. For example:</p><pre>SELECT count(1) FROM invoice WHERE amount=0 OR amount IS NULL Important Limitations</pre>Access
      control applies to query methods. See <a href="Security and access control.htm">Security and Access Control</a> for more details. Passwords cannot be
      retrieved through the query API due to security precautions.When applying these statements to
      lookup fields, the <code>selectQuery()</code> and <code>selectValue()</code> methods return the first related ID. If you need to
      retrieve all related IDs, use the <code>getRelatedIds()</code> method. <p>Some security precautions related to queries:</p><ul><li value="1">5000 characters or less <div class="draft-comment">Reviewers, does
            this mean the query expression itself must be less than 5K or the
            results?</div></li><li value="2">Cannot include separators: ; \n /</li><li value="3">Cannot include reserved words: <code>ALTER</code>,
            <code>BEGIN</code>, <code>CALL</code>, <code>CASCADE</code>, <code>DELETE</code>, <code>DROP</code>, <code>DATABASE</code>, <code>GRANT</code>, <code>EXECUTE</code>, INSERT,
          REVOKE, <code>RENAME</code>, <code>SHUTDOWN</code>, <code>SCHEMA</code>, <code>UPDATE</code>, <code>LOGIN_NAME</code>, <code>PASSWORD</code></li></ul><p>You can also use queries with parameters (see the method descriptions).
        Modifying the previous example to use parameter results in these statements:</p><code>count(1) FROM USER WHERE name LIKE ?</code>SELECT <p>Then, supply the SQL query parameter 'M%'</p><div class="draft-comment">Reviewers: What does the previous mean? where did M% come
        from?</div><p>You can perform JavaScript calculations and then pass results to a SQL
        query with parameters. This technique has a number of advantages over embedding variables
        directly into the text of a SQL query. To select ID of related record you can use query
        similar to this: </p><pre> select R1234 from
    invoice where id={!id}</pre><p>However please keep in mind that this query will only work for single
        relationships (1:1 and N:1). For multiple relationships (1:N and N:N) result of this query
        is undetermined. You should use <code>getRelatedIds()</code> or a
        template loop. </p></div>
                                        <div class="section">
                                            <h2 class="sectiontitle">Using the UI to Design a Query</h2>
                                            <div class="draft-comment">Writers, this section belongs somewhere else</div>
                                            <p>To design and test your query you can use specially designed helper page.
        Click the <span class="uicontrol">Test Query</span> button below formula text area
        to pop up that helper page. Enter your query starting with the <code>SELECT</code> keyword. Use merge tokens corresponding to all available fields and
        objects, as well as available SQL operands and built-in functions. To test your query,
        select a record of the current object type and click <span class="uicontrol">Test</span>. The system will display the parsed query and results (up to 10 rows) or
        error message. When you finish your testing - copy the resulting SQL query into the body of
        your formula as the first parameter to one of the query methods.</p>
                                            <p>The following shows an example query:</p>
                                            <p>
                                                <img src="rfi1391098305340.jpg" style="width: 615px;height: 355px;" alt="" />
                                            </p>
                                            <p>&#160;</p>
                                        </div>
                                    </div>
                                    <div class="MCMiniTocBox_0 miniToc nocontent" data-mc-autonum="In this section:" data-mc-depth="1" data-mc-toc="True"><span class="autonumber"><span class="miniTocBoxTitle">In this section:</span></span>
                                    </div>
                                    <div class="home-footer">
                                        <p class="footer" style="color: #4d4d4d; text-align: right; vertical-align: middle;">© 2022 <a style="color: #4d4d4d;" href="http://www.infiniteblue.com/">Infinite Blue Platform</a>. All rights reserved.</p>
                                    </div>
                                </div>
                            </main>
                        </div>
                    </div><a data-close="true"></a>
                </div>
            </div>
        </div>
    </body>
</html>